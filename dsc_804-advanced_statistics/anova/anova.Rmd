---
title: "One-Way Anova: Iris Dataset"
author: "Bett Kipkemoi"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = NA)
```

# ONE-WAY ANOVA
The goal in this project is to analyze if test whether there are significant differences among the group means. 

## Understanding the Dataset
The Iris dataset is one of the most famous and widely used datasets in machine learning and statistics. It was introduced by the British statistician and biologist Ronald Fisher in 1936 as an example for discriminant analysis. 

- Size: 150 samples (rows).
- Features: 4 numerical measurements (in centimeters):

    - Sepal length
    - Sepal width
    - Petal length
    - Petal width
    
- Target variable: Species of the iris flower (categorical, 3 classes with 50 samples each):

    - Iris setosa
    - Iris versicolor
    - Iris Virginica

The dataset is balanced, well-behaved, and often used for classification tasks, clustering, and statistical testing. The three species can be largely distinguished based on these measurements, especially petal length and width.

## Data Cleaning and Exploration

To be able to load the dataset, clean, explore, visualize and perform all the analyses, we have to load the necessary libraries. For this project, ggplot2, car, dplyr and DescTools are used. After calling the libraries, we the load the data and explore accordingly. From the data exploration, there are no missing values and all 150 observations.  No handling is required, as the data is clean and complete.

```{r loading necessary libraries, include=FALSE}
library(ggplot2)
library(car)
library(dplyr)
library(DescTools)
```
**Exploring the Data **
```{r loading the data and exploring, echo=FALSE}
# Step 1: Load the iris dataset
data(iris)
sum(is.na(iris))# checking for total missing values
colSums(is.na(iris)) # missing values in columns
```

\newpage

**Summary Statistics and EDA **
```{r Summary Statistics and EDA, echo=FALSE}
knitr::opts_chunk$set(comment = "")
cat("\nSummary Statistics:\n")
summarystats <- summary(iris)
print(summarystats)
cat("\nHistogram:\n")
hist(iris$Petal.Length, 
     main="Histogram of Petal Length", 
     col="skyblue",
     xlab = "bins",
     ylab = "Petal Length (cm)")
```
\newpage

```{r boxplots for each feaures, echo=FALSE}
# boxplots for each of the four features grouped by species in a 2x2 layout:
cat("\nBox Plots:\n")
# set up a 2x2 plotting layout
par(mfrow = c(2, 2))

# Boxplots for each feature by Species
boxplot(Sepal.Length ~ Species, data = iris, 
        main = "Sepal Length by Species", 
        col = "lightblue", 
        ylab = "Sepal Length (cm)")

boxplot(Sepal.Width ~ Species, data = iris, 
        main = "Sepal Width by Species", 
        col = "lightgreen", 
        ylab = "Sepal Width (cm)")

boxplot(Petal.Length ~ Species, data = iris, 
        main = "Petal Length by Species", 
        col = "lightpink", 
        ylab = "Petal Length (cm)")

boxplot(Petal.Width ~ Species, data = iris, 
        main = "Petal Width by Species", 
        col = "lightyellow", 
        ylab = "Petal Width (cm)")
```

## Assumption Checking

Before conducting ANOVA, we have to check for the following assumptions:

- Normality: Are the response variable values within each group approximately normally distributed? We use visual methods (histograms, Q-Q plots)

- Homogeneity of Variances: Are the group variances approximately equal? Use Levene’s test or Bartlett’s test.

```{r assumptions checking, echo=FALSE}
## Normality - Q-Q plot
par(mfrow = c(1, 3))  # Arrange the plots side by side
for (species in levels(iris$Species)) {
  qqnorm(iris$Sepal.Length[iris$Species == species], main = paste("Q-Q plot for", species))
  qqline(iris$Sepal.Length[iris$Species == species], col = "red")
}

## Homogeneity of variance - Levene's Test
leveneTest(Sepal.Length ~ Species, data = iris)
```

From the plots, distributions of sepal length and sepal width generally adhere to normality across all three species (setosa, versicolor, and virginica), although for setosa and virginica, there is a slight deviation at the 1-2 quantiles.

## ANOVA Analysis

The null and alternative hypotheses are:

  - H0 : The means of all groups are equal.
  - H1 : At least one group mean is different.
  
```{r ANOVA Analysis, echo=FALSE}
# Perform one-way ANOVA
anova_result <- aov(Sepal.Length ~ Species, data = iris)

# Check the summary of ANOVA
summary(anova_result)
## ANOVA Results
cat("\nANOVA Results:\n")
anova_summary <- summary(anova_result)
print(anova_summary)
```

The F-statistic of approximately 119.3 is very large, indicating substantial variation between group means (species) relative to within-group variation. The p-value (2×10^16) is less than 0 '***', inferring there is strong evidence to reject the null hypothesis that the mean sepal length is equal across all three species. The between-group sum of squares (63.21) accounts for most of the total variation, underscoring the species effect. While ANOVA confirms at least one pairwise difference exists, it does not specify which pairs differ—follow-up post-hoc tests, such as the Tukey's HSD, would reveal whether all three pairwise comparisons are significant.


```{r posthoc analysis, echo=FALSE}
# Post-hoc analysis using Tukey's HSD test
post_hoc_result <- TukeyHSD(anova_result)
summary(post_hoc_result)
# Post-hoc analysis (Tukey's HSD test)
cat("\nPost-hoc Analysis (Tukey's HSD):\n")
print(post_hoc_result)
```
## Post-Hoc Analysis and Interpretation

All three pairwise comparisons show highly significant differences (adjusted p = 0.0000). Iris virginica has the longest mean sepal length, significantly longer than both versicolor (by 0.652 cm) and setosa (by 1.582 cm). Iris versicolor has intermediate sepal length, significantly longer than setosa (by 0.930 cm). Iris setosa has the shortest mean sepal length. The 95% confidence intervals for all differences do not include zero, confirming that none of the pairwise differences could reasonably be due to chance. Tukey's HSD confirms that all three Iris species have statistically distinct mean sepal lengths, with a clear ordering: setosa < versicolor < virginica. This supports the strong discriminatory power of sepal length for distinguishing among the species, consistent with the extremely significant ANOVA result (F = 119.3, p < 2e-16). Although petal measurements typically separate the species even more clearly, sepal length alone is sufficient to detect highly significant differences between all pairs.

\newpage

## Code
```{r ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
  
  